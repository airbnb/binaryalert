import "hash"

rule ATM_Malware_NVISOSPIT {
	meta:
		description = "Detects ATM Malware NVISOSPIT"
		author = "Frank Boldewin (@r3c0nst)"
		reference = "https://twitter.com/r3c0nst/status/1134403094157115392"
		date = "2019-05-31"
		hash = "d7ce7b152f0da49e96fa32a9336b35253905d9940b001288d0df55d8f8b3951f"
		
	strings:
		$MalwareName = "NVISOSPIT" ascii fullword
		$DispenseCommand = "Calling WFSExecute() to dispense $%d" fullword ascii
		// CurrencyID --> Kyat MMK (Currency in Myanmar)
		$Code = {C6 85 7D F9 FF FF 4D C6 85 7E F9 FF FF 4D C6 85 7F F9 FF FF 4B}
	condition:
		uint16(0) == 0x5A4D and filesize < 100KB and 2 of them
}
